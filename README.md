# Анализ с помощью Chrome DevTools страницы rigla.ru

В данном проекте нужно проанализировать веб-страницу и дать рекомендации по ее оптимизации.

## Подготовка:

Страница открыта в режиме Инкогнито, для предотвращения нагрузки от сторонних плагинов браузера Chromium. На вкладке `Network` отключен cache, что эмулирует первый заход пользователя на страницу, когда у него пустой кэш.

## Network:

1. Для начала записал `network.har`, HAR архив профиль загрузки ресурсов при открытии страницы. Файлы HAR (HTTP Archive) фиксируют различные проблемы браузера, такие как неудачные входы и проблемы с отображением веб-страниц.

2. Поиск неоптимальных мест:

   - Дублирование ресурсов. Вел поиск полных соответствий `name, url, параметров headers`.

     Два одинаковых запроса, требующих высокий уровень степени защиты:
     ![2.1](./img/normal/duplicate-1.png)

     `graphql` — кэшируется 12 раз с разными тэгами, причем `FPC` — полный кэш страницы:
     ![2.2](./img/normal/duplicate-2.png)

     Меняется только порядок правил доступа CORS к ресурсам между доменами — `tp2` 3 запроса:
     ![2.3](./img/normal/duplicate-3.png)

     Попарно одинаковые запросы на Google Fonts:
     ![2.4](./img/normal/duplicate-4.png)

     Каждый `.jpeg` и `.png` на странице запрашивается по 2 раза:
     ![2.5](./img/normal/duplicate-4.png)

   - Лишний размер ресурсы, чаще всего `.png` и `.jpeg` форматы, которые можно сжать, поиск по размеру Size выше 10kB:

     ![2.6](./img/normal/size-1.png)

     Сюда можно отнести неиспользуемые js файлы:
     ![2.7](./img/normal/size-2.png)
     ![2.8](./img/normal/size-3.png)

   - Медленно загружающиеся ресурсы, замедляют общую производительность. Это контент с большим ожиданием ответа от сервера, зеленая шкала `Waterflow`:

     ![2.9](./img/normal/slow-1.png)

   - Ресурсы, блокирующие загрузку. В `Waterflow` обозначены серой шкалой `Stalled`:

     ![2.10](./img/normal/block-1.png)

     Скрипты от Яндекс, Google и от других сторонних источников также блокируют основной поток:
     ![2.12](./img/normal/block-2.png)
     ![2.13](./img/normal/block-3.png)

3. Другие не оптимальности, заблокированный запрос политикой CORS, ошибка доступа, доступ к геолокации отклонен, неудачная попытка создания WebGPU, неудачная попытка парса видео:

   ![3.1](./img/normal/other-1.png)
   ![3.2](./img/normal/other-2.png)

## Performance

1. Записал файл загрузки `performance.json`.

2. Время в миллисекундах от начала навигации до событий (шкала `Timings`):

   ![2.1](./img/normal/performance-1.png)

   - First Paint (FP) – когда пользователь впервые что-то увидел, `2362.2 ms`
   - First Contentful Paint (FCP) – когда браузер отображает первый элемент содержимого (текст, изображение, SVG, не пустой canvas), `2362.2 ms`
   - Largest Contentful Paint (LCP) – время, необходимое для отображения на экране наибольшего элемента содержимого (изображение, текстовый блок и т.д.) при первом загрузке страницы, `6513.6 ms`
   - DOM Content Loaded (DCL) – показывает, когда основной контент страницы готов к взаимодействию, `1863.8 ms`
   - Load (L) – страница полностью загружена, `6720.2 ms`

3. LCP происходит на DOM-элементе `img.popup-metadata-type-slider__img`:

   ![2.2](./img/normal/performance-2.png)

4. Сколько времени в миллисекундах тратится на разные этапы обработки документа (шкала Main, Summary):

   ![2.3](./img/normal/performance-3.png)

   - Loading, 23ms
   - Scripting, 2816 ms
   - Rendering, 323 ms
   - Painting, 112 ms

## Coverage

1. Вкладка Coverage после загрузки страницы:

   ![1.1](./img/normal/coverage-1.png)

2. Объём в Кб неиспользованного CSS в ходе загрузки страницы — 45,4 Кб:
   ![2.1](./img/normal/coverage-2.png)

3. Объём в Кб неиспользованного JS в ходе загрузки страницы — 5900 Кб:
   ![3.1](./img/normal/coverage-3.png)

# Анализ с помощью Chrome DevTools замедленной страницы rigla.ru

Этот анализ со включенным замедлением CPU 4x slowdown и эмуляцией сети Slow 3G.

## Подготовка:

Страница открыта в режиме Инкогнито, для предотвращения нагрузки от сторонних плагинов браузера Chromium. На вкладке Network отключен cache, что эмулирует первый заход пользователя на страницу, когда у него пустой кэш. Во вкладке Performance выставлены значения троттлинга Slow 3G и CPU 4x slowdown.

![1.1](./img/with-throttling/settings.png)

## Network

Увеличилось время для загрузки ресурсов, еще больше замедлилась общая производительность страницы.

![1.1](./img/with-throttling/network-slowed.png)

Увеличилось время блокировки ресурсов, также добавился новый запрос `7733`.

![1.2](./img/with-throttling/network-slowed-2.png)

## Performance

1. Записал новый файл загрузки performance-slowed.json

2. Время в миллисекундах от начала навигации до событий (шкала `Timings`) значительно увеличилось:

   ![2.1](./img/with-throttling/performance-1.png)

   - First Paint (FP) – когда пользователь впервые что-то увидел, `26441.4 ms`
   - First Contentful Paint (FCP) – когда браузер отображает первый элемент содержимого (текст, изображение, SVG, не пустой canvas), `26441.4 ms`
   - Largest Contentful Paint (LCP) – время, необходимое для отображения на экране наибольшего элемента содержимого (изображение, текстовый блок и т.д.) при первом загрузке страницы, `26441.4 ms`
   - DOM Content Loaded (DCL) – показывает, когда основной контент страницы готов к взаимодействию, `38115.6 ms`
   - Load (L) – страница полностью загружена, `41673.2 ms`

   * Рендеры LCP и DCL поменялись местами

3. LCP происходит на DOM-элементе `img`:

   ![2.2](./img/with-throttling/performance-2.png)

4. Сколько времени в миллисекундах тратится на разные этапы обработки документа (шкала Main, Summary):

   ![2.3](./img/with-throttling/performance-3.png)

   - Loading, 33ms
   - Scripting, 4160 ms
   - Rendering, 99 ms
   - Painting, 34 ms
